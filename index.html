<div style="margin-top: 20px; display: flex; gap: 10px;">
                    <button type="submit" class="btn btn-success">üíæ Kaydet ve Devam Et</button>
                    <button type="button" class="btn btn-primary" onclick="saveAndNew()">üíæ Kaydet ve Yeni</button>
                    <button type="button" class="btn" onclick="closeModal('quickEntryModal')">‚ùå Kapat</button>
                </div>
                
                <div style="margin-top: 15px; padding: 10px; background: #e3f2fd; border-radius: 5px;">
                    <small>üí° ƒ∞pucu: PDF'lerinizi a√ßƒ±k tutun ve Tab tu≈üu ile alanlar arasƒ± hƒ±zla ge√ßi≈ü yapƒ±n.</small>
                </div>
            </form>
        </div>
    </div>

    <!-- PDF G√∂r√ºnt√ºleme Modal -->
    <div id="pdfViewerModal" class="modal">
        <div class="modal-content" style="max-width: 90%; max-height: 90%;">
            <span class="close" onclick="closeModal('pdfViewerModal')">&times;</span>
            <h3>üìÑ PDF G√∂r√ºnt√ºleyici</h3>
            <div id="pdfViewerContent" style="text-align: center; margin-top: 20px;">
                <p>PDF dosyalarƒ±nƒ±z burada g√∂r√ºnt√ºlenecek.</p>
            </div>
        </div>
    </div>

    <!-- Gizli dosya input -->
    <input type="file" id="fileInput" accept=".json" style="display: none;">

    <script>
        // Veri depolama - localStorage ile kalƒ±cƒ±
        let isTalepleri = JSON.parse(localStorage.getItem('mca_is_talepleri') || '[]');
        let servisFormlari = JSON.parse(localStorage.getItem('mca_servis_formlari') || '[]');
        let ayarlar = JSON.parse(localStorage.getItem('mca_ayarlar') || '{"firmaAdi":"MCA MECHANICAL","bolge":"Antalya","varsayilanTeknisyen":"","paraBirimi":"TL"}');
        let pdfFiles = JSON.parse(localStorage.getItem('mca_pdf_files') || '[]');

        // Sayfa y√ºklendiƒüinde
        document.addEventListener('DOMContentLoaded', function() {
            initializePage();
            updateAllTables();
            updateSummary();
            updateArchiveStats();
            loadSettingsToForm();
            setupPDFUpload();
            setupModalEvents(); // Modal event'lerini kur
        });

        // Modal event'lerini kurma
        function setupModalEvents() {
            // T√ºm close butonlarƒ± i√ßin event listener ekle
            document.querySelectorAll('.close').forEach(closeBtn => {
                closeBtn.onclick = function() {
                    this.closest('.modal').style.display = 'none';
                };
            });
        }

        function initializePage() {
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('tarih').value = today;
            document.getElementById('formTarihi').value = today;
            
            // Demo veri ekle (eƒüer bo≈üsa)
            if (isTalepleri.length === 0) {
                isTalepleri.push({
                    id: Date.now(),
                    musteriAdi: "ABC Ofis Merkezi",
                    telefon: "0242 123 45 67",
                    adres: "Muratpa≈üa, Antalya",
                    isTuru: "bakim",
                    cihazTipi: "VRF Klima Sistemi",
                    ustLimit: 1500,
                    tarih: today,
                    oncelik: "normal",
                    isAciklamasi: "Yƒ±llƒ±k bakƒ±m i≈ülemi",
                    durum: 'bekliyor',
                    olusturmaTarihi: new Date().toISOString()
                });
                saveData();
            }
        }

        function saveData() {
            localStorage.setItem('mca_is_talepleri', JSON.stringify(isTalepleri));
            localStorage.setItem('mca_servis_formlari', JSON.stringify(servisFormlari));
            localStorage.setItem('mca_ayarlar', JSON.stringify(ayarlar));
            localStorage.setItem('mca_pdf_files', JSON.stringify(pdfFiles));
        }

        function showTab(tabName) {
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            
            document.querySelectorAll('.tab-button').forEach(button => {
                button.classList.remove('active');
            });
            
            document.getElementById(tabName).classList.add('active');
            event.target.classList.add('active');
        }

        // ƒ∞≈ü talebi ekleme
        document.getElementById('isTalebiForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const yeniTalep = {
                id: Date.now(),
                musteriAdi: document.getElementById('musteriAdi').value,
                telefon: document.getElementById('telefon').value,
                adres: document.getElementById('adres').value,
                isTuru: document.getElementById('isTuru').value,
                cihazTipi: document.getElementById('cihazTipi').value,
                ustLimit: parseFloat(document.getElementById('ustLimit').value),
                tarih: document.getElementById('tarih').value,
                oncelik: document.getElementById('oncelik').value,
                isAciklamasi: document.getElementById('isAciklamasi').value,
                durum: 'bekliyor',
                olusturmaTarihi: new Date().toISOString()
            };
            
            isTalepleri.push(yeniTalep);
            saveData();
            updateAllTables();
            updateSummary();
            
            this.reset();
            document.getElementById('tarih').value = new Date().toISOString().split('T')[0];
            
            showNotification('ƒ∞≈ü talebi ba≈üarƒ±yla eklendi!', 'success');
        });

        // Servis formu ekleme
        document.getElementById('servisFormForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const isTalebiId = parseInt(document.getElementById('isTalebiSec').value);
            const isTalebi = isTalepleri.find(t => t.id === isTalebiId);
            
            if (!isTalebi) {
                showNotification('L√ºtfen ge√ßerli bir i≈ü talebi se√ßin!', 'error');
                return;
            }
            
            const iscilikUcreti = parseFloat(document.getElementById('iscilikUcreti').value);
            
            if (iscilikUcreti > isTalebi.ustLimit) {
                showNotification(`ƒ∞≈ü√ßilik √ºcreti √ºst limiti (${isTalebi.ustLimit} TL) a≈üamaz!`, 'error');
                return;
            }
            
            const yeniForm = {
                id: Date.now(),
                isTalebiId: isTalebiId,
                teknisyenAdi: document.getElementById('teknisyenAdi').value,
                baslangicSaati: document.getElementById('baslangicSaati').value,
                bitisSaati: document.getElementById('bitisSaati').value,
                iscilikUcreti: iscilikUcreti,
                formTarihi: document.getElementById('formTarihi').value,
                yapilanIsler: document.getElementById('yapilanIsler').value,
                notlar: document.getElementById('notlar').value,
                durum: 'onay-bekliyor',
                olusturmaTarihi: new Date().toISOString()
            };
            
            servisFormlari.push(yeniForm);
            isTalebi.durum = 'isleniyor';
            
            saveData();
            updateAllTables();
            updateSummary();
            
            this.reset();
            document.getElementById('formTarihi').value = new Date().toISOString().split('T')[0];
            
            showNotification('Servis formu ba≈üarƒ±yla kaydedildi!', 'success');
        });

        // PDF olu≈üturma
        function generatePDF() {
            const isTalebiId = parseInt(document.getElementById('isTalebiSec').value);
            if (!isTalebiId) {
                showNotification('L√ºtfen √∂nce bir i≈ü talebi se√ßin!', 'error');
                return;
            }
            
            const talep = isTalepleri.find(t => t.id === isTalebiId);
            const formData = {
                teknisyen: document.getElementById('teknisyenAdi').value,
                baslangic: document.getElementById('baslangicSaati').value,
                bitis: document.getElementById('bitisSaati').value,
                ucret: document.getElementById('iscilikUcreti').value,
                tarih: document.getElementById('formTarihi').value,
                yapilanIsler: document.getElementById('yapilanIsler').value,
                notlar: document.getElementById('notlar').value
            };
            
            // PDF i√ßeriƒüi olu≈ütur
            let content = `MCA MECHANICAL\n`;
            content += `SERVƒ∞S RAPORU\n`;
            content += `=====================================\n\n`;
            content += `M√º≈üteri: ${talep.musteriAdi}\n`;
            content += `Telefon: ${talep.telefon || 'Belirtilmemi≈ü'}\n`;
            content += `Adres: ${talep.adres}\n`;
            content += `ƒ∞≈ü T√ºr√º: ${talep.isTuru.toUpperCase()}\n`;
            content += `Cihaz: ${talep.cihazTipi}\n`;
            content += `Tarih: ${formData.tarih}\n`;
            content += `Teknisyen: ${formData.teknisyen}\n`;
            content += `√áalƒ±≈üma Saati: ${formData.baslangic} - ${formData.bitis}\n`;
            content += `ƒ∞≈ü√ßilik √úcreti: ${formData.ucret} ${ayarlar.paraBirimi}\n\n`;
            content += `Yapƒ±lan ƒ∞≈üler:\n${formData.yapilanIsler}\n\n`;
            
            if (formData.notlar) {
                content += `Notlar:\n${formData.notlar}\n\n`;
            }
            
            content += `\n\nTeknisyen ƒ∞mzasƒ±: _______________    M√º≈üteri ƒ∞mzasƒ±: _______________\n\n`;
            content += `Form Tarihi: ${new Date().toLocaleString('tr-TR')}\n`;
            content += `MCA MECHANICAL - ${ayarlar.bolge}`;
            
            downloadTextFile(content, `servis_formu_${talep.musteriAdi}_${formData.tarih}.txt`);
            showNotification('PDF formu indirildi!', 'success');
        }

        // PDF y√ºkleme sistemi
        function setupPDFUpload() {
            const pdfInput = document.getElementById('pdfInput');
            const pdfPreview = document.getElementById('pdfPreview');
            
            pdfInput.addEventListener('change', function(e) {
                const files = e.target.files;
                
                for (let i = 0; i < files.length; i++) {
                    const file = files[i];
                    
                    // Dosya boyutu kontrol√º (5MB)
                    if (file.size > 5 * 1024 * 1024) {
                        showNotification(`${file.name} dosyasƒ± √ßok b√ºy√ºk (max 5MB)`, 'error');
                        continue;
                    }
                    
                    const reader = new FileReader();
                    reader.onload = function(event) {
                        const pdfData = {
                            id: Date.now() + Math.random(),
                            name: file.name,
                            type: file.type,
                            size: file.size,
                            data: event.target.result,
                            uploadDate: new Date().toISOString()
                        };
                        
                        pdfFiles.push(pdfData);
                        saveData();
                        displayPDFPreview();
                        updateArchiveStats();
                    };
                    
                    reader.readAsDataURL(file);
                }
            });
            
            displayPDFPreview();
        }

        function displayPDFPreview() {
            const pdfPreview = document.getElementById('pdfPreview');
            pdfPreview.innerHTML = '';
            
            pdfFiles.forEach((pdf, index) => {
                const pdfItem = document.createElement('div');
                pdfItem.className = 'pdf-item';
                
                pdfItem.innerHTML = `
                    <div style="margin-bottom: 10px;">
                        ${pdf.type.includes('pdf') ? 'üìÑ' : 'üñºÔ∏è'} 
                    </div>
                    <strong>${pdf.name}</strong>
                    <p style="font-size: 12px; color: #666;">
                        ${formatBytes(pdf.size)}<br>
                        ${formatDate(pdf.uploadDate)}
                    </p>
                    <div style="margin-top: 10px;">
                        <button class="btn btn-primary btn-small" onclick="viewPDF(${index})">üëÅÔ∏è G√∂r√ºnt√ºle</button>
                        <button class="btn btn-danger btn-small" onclick="deletePDF(${index})">üóëÔ∏è Sil</button>
                    </div>
                `;
                
                pdfPreview.appendChild(pdfItem);
            });
        }

        function viewPDF(index) {
            const pdf = pdfFiles[index];
            const modal = document.getElementById('pdfViewerModal');
            const content = document.getElementById('pdfViewerContent');
            
            if (pdf.type.includes('pdf')) {
                content.innerHTML = `
                    <embed src="${pdf.data}" width="100%" height="600px" type="application/pdf">
                    <p style="margin-top: 10px;">
                        <a href="${pdf.data}" download="${pdf.name}" class="btn btn-primary">üíæ ƒ∞ndir</a>
                    </p>
                `;
            } else {
                content.innerHTML = `
                    <img src="${pdf.data}" style="max-width: 100%; max-height: 600px;" alt="${pdf.name}">
                    <p style="margin-top: 10px;">
                        <a href="${pdf.data}" download="${pdf.name}" class="btn btn-primary">üíæ ƒ∞ndir</a>
                    </p>
                `;
            }
            
            modal.style.display = 'block';
        }

        function deletePDF(index) {
            if (confirm('Bu PDF dosyasƒ±nƒ± silmek istediƒüinizden emin misiniz?')) {
                pdfFiles.splice(index, 1);
                saveData();
                displayPDFPreview();
                updateArchiveStats();
                showNotification('PDF dosyasƒ± silindi', 'success');
            }
        }

        function showPDFViewer() {
            if (pdfFiles.length === 0) {
                showNotification('Hen√ºz PDF dosyasƒ± y√ºklenmemi≈ü', 'warning');
                return;
            }
            viewPDF(0);
        }

        // Hƒ±zlƒ± giri≈ü fonksiyonlarƒ±
        function openQuickEntry() {
            document.getElementById('quickEntryModal').style.display = 'block';
            document.getElementById('qFormTarihi').value = new Date().toISOString().split('T')[0];
        }

        document.getElementById('quickEntryForm').addEventListener('submit', function(e) {
            e.preventDefault();
            saveQuickEntry(false);
        });

        function saveAndNew() {
            saveQuickEntry(true);
        }

        function saveQuickEntry(clearForm) {
            // ƒ∞≈ü talebi olu≈ütur
            const isTalebi = {
                id: Date.now(),
                musteriAdi: document.getElementById('qMusteriAdi').value,
                telefon: document.getElementById('qTelefon').value,
                adres: document.getElementById('qAdres').value,
                isTuru: document.getElementById('qIsTuru').value,
                cihazTipi: document.getElementById('qCihazTipi').value,
                ustLimit: parseFloat(document.getElementById('qIscilik').value) * 1.2,
                tarih: document.getElementById('qFormTarihi').value,
                oncelik: "normal",
                isAciklamasi: "Eski formdan aktarƒ±ldƒ±",
                durum: 'tamamlandi',
                olusturmaTarihi: document.getElementById('qFormTarihi').value + 'T00:00:00.000Z'
            };
            
            isTalepleri.push(isTalebi);
            
            // Servis formu olu≈ütur
            const servisFormu = {
                id: Date.now() + 1,
                isTalebiId: isTalebi.id,
                teknisyenAdi: document.getElementById('qTeknisyen').value,
                baslangicSaati: document.getElementById('qBaslangic').value || '08:00',
                bitisSaati: document.getElementById('qBitis').value || '17:00',
                iscilikUcreti: parseFloat(document.getElementById('qIscilik').value),
                formTarihi: document.getElementById('qFormTarihi').value,
                yapilanIsler: document.getElementById('qYapilanIsler').value,
                notlar: document.getElementById('qNotlar').value + ' [Eski formdan aktarƒ±ldƒ±]',
                durum: 'onaylandi',
                olusturmaTarihi: document.getElementById('qFormTarihi').value + 'T00:00:00.000Z'
            };
            
            servisFormlari.push(servisFormu);
            
            saveData();
            updateAllTables();
            updateSummary();
            
            if (clearForm) {
                const tarih = document.getElementById('qFormTarihi').value;
                document.getElementById('quickEntryForm').reset();
                document.getElementById('qFormTarihi').value = tarih;
                document.getElementById('qMusteriAdi').focus();
                showNotification('Form kaydedildi! Yeni form i√ßin hazƒ±r.', 'success');
            } else {
                closeModal('quickEntryModal');
                showNotification('Eski form ba≈üarƒ±yla sisteme aktarƒ±ldƒ±!', 'success');
            }
        }

        function updateAllTables() {
            updateIsTalepleriTable();
            updateServisFormlariTable();
            updateIsTalebiSelect();
        }

        function updateIsTalepleriTable() {
            const tbody = document.getElementById('isTalepleriTbody');
            tbody.innerHTML = '';
            
            isTalepleri.sort((a, b) => new Date(b.olusturmaTarihi) - new Date(a.olusturmaTarihi)).forEach(talep => {
                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td>${formatDate(talep.tarih)}</td>
                    <td><strong>${talep.musteriAdi}</strong></td>
                    <td><span style="background: #e3f2fd; padding: 2px 8px; border-radius: 10px; font-size: 11px;">${talep.isTuru.toUpperCase()}</span></td>
                    <td>${talep.cihazTipi}</td>
                    <td><strong>${talep.ustLimit.toFixed(2)} ${ayarlar.paraBirimi}</strong></td>
                    <td><span class="status-badge status-${getStatusClass(talep.durum)}">${getDurumText(talep.durum)}</span></td>
                    <td>
                        <button class="btn btn-primary btn-small" onclick="showDetail('is', ${talep.id})" title="Detay">üëÅÔ∏è</button>
                        <button class="btn btn-danger btn-small" onclick="deleteIsTalebi(${talep.id})" title="Sil">üóëÔ∏è</button>
                    </td>
                `;
                tbody.appendChild(tr);
            });
        }

        function updateServisFormlariTable() {
            const tbody = document.getElementById('servisFormlariTbody');
            tbody.innerHTML = '';
            
            servisFormlari.sort((a, b) => new Date(b.formTarihi) - new Date(a.formTarihi)).forEach(form => {
                const isTalebi = isTalepleri.find(t => t.id === form.isTalebiId);
                
                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td>${formatDate(form.formTarihi)}</td>
                    <td><strong>${form.teknisyenAdi}</strong></td>
                    <td>${isTalebi ? isTalebi.musteriAdi : 'Silinmi≈ü Talep'}</td>
                    <td>${calculateDuration(form.baslangicSaati, form.bitisSaati)}</td>
                    <td><strong>${form.iscilikUcreti.toFixed(2)} ${ayarlar.paraBirimi}</strong></td>
                    <td><span class="status-badge status-${getStatusClass(form.durum)}">${getDurumText(form.durum)}</span></td>
                    <td>
                        <button class="btn btn-primary btn-small" onclick="showDetail('form', ${form.id})" title="Detay">üëÅÔ∏è</button>
                        <button class="btn btn-success btn-small" onclick="approveForm(${form.id})" title="Onayla">‚úÖ</button>
                        <button class="btn btn-warning btn-small" onclick="generateFormPDF(${form.id})" title="PDF">üìÑ</button>
                        <button class="btn btn-danger btn-small" onclick="deleteServisForm(${form.id})" title="Sil">üóëÔ∏è</button>
                    </td>
                `;
                tbody.appendChild(tr);
            });
        }

        function updateIsTalebiSelect() {
            const select = document.getElementById('isTalebiSec');
            select.innerHTML = '<option value="">ƒ∞≈ü Talebi Se√ßin...</option>';
            
            isTalepleri.filter(t => t.durum !== 'tamamlandi').forEach(talep => {
                const option = document.createElement('option');
                option.value = talep.id;
                option.textContent = `${talep.musteriAdi} - ${talep.isTuru.toUpperCase()}`;
                select.appendChild(option);
            });
        }

        function updateSummary() {
            const toplamTalep = isTalepleri.length;
            const tamamlanan = isTalepleri.filter(t => t.durum === 'tamamlandi').length;
            const bekleyen = isTalepleri.filter(t => t.durum === 'bekliyor').length;
            
            const onaylananFormlar = servisFormlari.filter(f => f.durum === 'onaylandi');
            const toplamKazanc = onaylananFormlar.reduce((total, form) => total + form.iscilikUcreti, 0);
            
            document.getElementById('toplamIsTalepleri').textContent = toplamTalep;
            document.getElementById('tamamlananIsler').textContent = tamamlanan;
            document.getElementById('bekleyenIsler').textContent = bekleyen;
            document.getElementById('toplamKazanc').textContent = `${ayarlar.paraBirimi === 'TL' ? '‚Ç∫' : ayarlar.paraBirimi}${toplamKazanc.toFixed(2)}`;
        }

        function updateArchiveStats() {
            const veriBoyu = new Blob([JSON.stringify({
                isTalepleri,
                servisFormlari,
                ayarlar,
                pdfFiles: pdfFiles.map(p => ({...p, data: '[DATA]'})) // Veri boyutu i√ßin sadece meta bilgi
            })]).size;
            
            const pdfBoyu = pdfFiles.reduce((total, pdf) => total + pdf.size, 0);
            
            document.getElementById('arsivisTalepleri').textContent = isTalepleri.length;
            document.getElementById('arsivServisFormlari').textContent = servisFormlari.length;
            document.getElementById('arsivPDFSayisi').textContent = pdfFiles.length;
            document.getElementById('arsivVeriBoyu').textContent = formatBytes(veriBoyu + pdfBoyu);
        }

        // Form PDF'i olu≈üturma
        function generateFormPDF(formId) {
            const form = servisFormlari.find(f => f.id === formId);
            const talep = isTalepleri.find(t => t.id === form.isTalebiId);
            
            if (!form || !talep) {
                showNotification('Form veya i≈ü talebi bulunamadƒ±!', 'error');
                return;
            }
            
            let content = `MCA MECHANICAL\n`;
            content += `SERVƒ∞S RAPORU\n`;
            content += `=====================================\n\n`;
            content += `M√º≈üteri: ${talep.musteriAdi}\n`;
            content += `Telefon: ${talep.telefon || 'Belirtilmemi≈ü'}\n`;
            content += `Adres: ${talep.adres}\n`;
            content += `ƒ∞≈ü T√ºr√º: ${talep.isTuru.toUpperCase()}\n`;
            content += `Cihaz: ${talep.cihazTipi}\n`;
            content += `Tarih: ${form.formTarihi}\n`;
            content += `Teknisyen: ${form.teknisyenAdi}\n`;
            content += `√áalƒ±≈üma Saati: ${form.baslangicSaati} - ${form.bitisSaati}\n`;
            content += `ƒ∞≈ü√ßilik √úcreti: ${form.iscilikUcreti} ${ayarlar.paraBirimi}\n\n`;
            content += `Yapƒ±lan ƒ∞≈üler:\n${form.yapilanIsler}\n\n`;
            
            if (form.notlar) {
                content += `Notlar:\n${form.notlar}\n\n`;
            }
            
            content += `\n\nTeknisyen ƒ∞mzasƒ±: _______________    M√º≈üteri ƒ∞mzasƒ±: _______________\n\n`;
            content += `Form Tarihi: ${formatDate(form.formTarihi)}\n`;
            content += `MCA MECHANICAL - ${ayarlar.bolge}`;
            
            downloadTextFile(content, `servis_formu_${talep.musteriAdi}_${form.formTarihi}.txt`);
            showNotification('Form PDF\'i indirildi!', 'success');
        }

        // Yardƒ±mcƒ± fonksiyonlar
        function formatDate(dateString) {
            return new Date(dateString).toLocaleDateString('tr-TR');
        }

        function formatBytes(bytes) {
            if (bytes === 0) return '0 B';
            const k = 1024;
            const sizes = ['B', 'KB', 'MB'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            return parseFloat((bytes / Math.pow(k, i)).toFixed(1)) + ' ' + sizes[i];
        }

        function getStatusClass(durum) {
            const classes = {
                'bekliyor': 'pending',
                'isleniyor': 'pending',
                'tamamlandi': 'completed',
                'onay-bekliyor': 'pending',
                'onaylandi': 'approved'
            };
            return classes[durum] || 'pending';
        }

        function getDurumText(durum) {
            const durumlar = {
                'bekliyor': 'Bekliyor',
                'isleniyor': 'ƒ∞≈üleniyor',
                'tamamlandi': 'Tamamlandƒ±',
                'onay-bekliyor': 'Onay Bekliyor',
                'onaylandi': 'Onaylandƒ±'
            };
            return durumlar[durum] || durum;
        }

        function calculateDuration(start, end) {
            if (!start || !end) return '-';
            const startTime = new Date(`2000-01-01T${start}`);
            const endTime = new Date(`2000-01-01T${end}`);
            if (endTime <= startTime) return '-';
            
            const diff = endTime - startTime;
            const hours = Math.floor(diff / (1000 * 60 * 60));
            const minutes = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
            return `${hours}:${minutes.toString().padStart(2, '0')}`;
        }

        // Detay g√∂sterme
        function showDetail(type, id) {
            const modal = document.getElementById('detailModal');
            const content = document.getElementById('modalContent');
            
            if (type === 'is') {
                const talep = isTalepleri.find(t => t.id === id);
                if (talep) {
                    content.innerHTML = `
                        <h3>üìã ƒ∞≈ü Talebi Detaylarƒ±</h3>
                        <div style="margin: 20px 0;">
                            <p><strong>M√º≈üteri:</strong> ${talep.musteriAdi}</p>
                            <p><strong>Telefon:</strong> ${talep.telefon || 'Belirtilmemi≈ü'}</p>
                            <p><strong>Adres:</strong> ${talep.adres}</p>
                            <p><strong>ƒ∞≈ü T√ºr√º:</strong> ${talep.isTuru.toUpperCase()}</p>
                            <p><strong>Cihaz:</strong> ${talep.cihazTipi}</p>
                            <p><strong>√úst Limit:</strong> ${talep.ustLimit.toFixed(2)} ${ayarlar.paraBirimi}</p>
                            <p><strong>Planlanan Tarih:</strong> ${formatDate(talep.tarih)}</p>
                            <p><strong>√ñncelik:</strong> ${talep.oncelik.toUpperCase()}</p>
                            <p><strong>Durum:</strong> ${getDurumText(talep.durum)}</p>
                            <p><strong>A√ßƒ±klama:</strong> ${talep.isAciklamasi || 'Belirtilmemi≈ü'}</p>
                        </div>
                    `;
                }
            } else if (type === 'form') {
                const form = servisFormlari.find(f => f.id === id);
                const talep = isTalepleri.find(t => t.id === form?.isTalebiId);
                if (form) {
                    content.innerHTML = `
                        <h3>üìù Servis Formu Detaylarƒ±</h3>
                        <div style="margin: 20px 0;">
                            <p><strong>M√º≈üteri:</strong> ${talep ? talep.musteriAdi : 'Silinmi≈ü Talep'}</p>
                            <p><strong>Teknisyen:</strong> ${form.teknisyenAdi}</p>
                            <p><strong>Tarih:</strong> ${formatDate(form.formTarihi)}</p>
                            <p><strong>√áalƒ±≈üma Saati:</strong> ${form.baslangicSaati} - ${form.bitisSaati}</p>
                            <p><strong>Toplam S√ºre:</strong> ${calculateDuration(form.baslangicSaati, form.bitisSaati)}</p>
                            <p><strong>ƒ∞≈ü√ßilik √úcreti:</strong> ${form.iscilikUcreti.toFixed(2)} ${ayarlar.paraBirimi}</p>
                            <p><strong>Durum:</strong> ${getDurumText(form.durum)}</p>
                        </div>
                        <div style="margin-top: 20px;">
                            <p><strong>Yapƒ±lan ƒ∞≈üler:</strong></p>
                            <div style="background: #f8f9fa; padding: 15px; border-radius: 8px; margin: 10px 0;">
                                ${form.yapilanIsler}
                            </div>
                            ${form.notlar ? `
                                <p><strong>Notlar:</strong></p>
                                <div style="background: #e3f2fd; padding: 15px; border-radius: 8px; margin: 10px 0;">
                                    ${form.notlar}
                                </div>
                            ` : ''}
                        </div>
                    `;
                }
            }
            
            modal.style.display = 'block';
        }

        // Silme i≈ülemleri
        function deleteIsTalebi(id) {
            if (confirm('Bu i≈ü talebini ve ilgili servis formlarƒ±nƒ± silmek istediƒüinizden emin misiniz?')) {
                isTalepleri = isTalepleri.filter(t => t.id !== id);
                servisFormlari = servisFormlari.filter(f => f.isTalebiId !== id);
                
                saveData();
                updateAllTables();
                updateSummary();
                showNotification('ƒ∞≈ü talebi silindi', 'success');
            }
        }

        function deleteServisForm(id) {
            if (confirm('Bu servis formunu silmek istediƒüinizden emin misiniz?')) {
                const form = servisFormlari.find(f => f.id === id);
                if (form) {
                    const talep = isTalepleri.find(t => t.id === form.isTalebiId);
                    if (talep && talep.durum === 'isleniyor') {
                        talep.durum = 'bekliyor';
                    }
                }
                
                servisFormlari = servisFormlari.filter(f => f.id !== id);
                
                saveData();
                updateAllTables();
                updateSummary();
                showNotification('Servis formu silindi', 'success');
            }
        }

        // Onaylama i≈ülemi
        function approveForm(id) {
            const form = servisFormlari.find(f => f.id === id);
            if (form && form.durum !== 'onaylandi') {
                form.durum = 'onaylandi';
                
                const talep = isTalepleri.find(t => t.id === form.isTalebiId);
                if (talep) {
                    talep.durum = 'tamamlandi';
                }
                
                saveData();
                updateAllTables();
                updateSummary();
                showNotification('Servis formu onaylandƒ±!', 'success');
            }
        }

        // Rapor olu≈üturma
        function generateReport() {
            const baslangic = document.getElementById('raporBaslangic').value;
            const bitis = document.getElementById('raporBitis').value;
            const tur = document.getElementById('raporTuru').value;
            
            if (!baslangic || !bitis) {
                showNotification('L√ºtfen ba≈ülangƒ±√ß ve biti≈ü tarihlerini se√ßin!', 'error');
                return;
            }
            
            const filtreliFormlar = servisFormlari.filter(form => {
                const formTarih = new Date(form.formTarihi);
                return formTarih >= new Date(baslangic) && formTarih <= new Date(bitis);
            });
            
            const raporSonuclari = document.getElementById('raporSonuclari');
            
            if (filtreliFormlar.length === 0) {
                raporSonuclari.innerHTML = '<p>Se√ßilen tarih aralƒ±ƒüƒ±nda veri bulunamadƒ±.</p>';
                return;
            }
            
            let raporHTML = `
                <div class="table-container">
                    <div class="table-header">
                        <h3>üìä ${tur.charAt(0).toUpperCase() + tur.slice(1)} Raporu</h3>
                        <span>${formatDate(baslangic)} - ${formatDate(bitis)}</span>
                    </div>
                    <table>
                        <thead>
                            <tr>
                                <th>Tarih</th>
                                <th>Teknisyen</th>
                                <th>M√º≈üteri</th>
                                <th>ƒ∞≈ü T√ºr√º</th>
                                <th>S√ºre</th>
                                <th>ƒ∞≈ü√ßilik</th>
                                <th>Durum</th>
                            </tr>
                        </thead>
                        <tbody>
            `;
            
            let toplamIscilik = 0;
            
            filtreliFormlar.forEach(form => {
                const talep = isTalepleri.find(t => t.id === form.isTalebiId);
                toplamIscilik += form.iscilikUcreti;
                
                raporHTML += `
                    <tr>
                        <td>${formatDate(form.formTarihi)}</td>
                        <td>${form.teknisyenAdi}</td>
                        <td>${talep ? talep.musteriAdi : 'Silinmi≈ü'}</td>
                        <td>${talep ? talep.isTuru.toUpperCase() : '-'}</td>
                        <td>${calculateDuration(form.baslangicSaati, form.bitisSaati)}</td>
                        <td>${form.iscilikUcreti.toFixed(2)} ${ayarlar.paraBirimi}</td>
                        <td><span class="status-badge status-${getStatusClass(form.durum)}">${getDurumText(form.durum)}</span></td>
                    </tr>
                `;
            });
            
            raporHTML += `
                        </tbody>
                    </table>
                    <div style="margin-top: 20px; padding: 20px; background: #f8f9fa; border-radius: 10px;">
                        <h4>üìà √ñzet:</h4>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-top: 15px;">
                            <div><strong>Toplam ƒ∞≈ü:</strong> ${filtreliFormlar.length}</div>
                            <div><strong>Toplam ƒ∞≈ü√ßilik:</strong> ${toplamIscilik.toFixed(2)} ${ayarlar.paraBirimi}</div>
                            <div><strong>Ortalama ƒ∞≈ü√ßilik:</strong> ${(toplamIscilik / filtreliFormlar.length).toFixed(2)} ${ayarlar.paraBirimi}</div>
                            <div><strong>Onaylanan:</strong> ${filtreliFormlar.filter(f => f.durum === 'onaylandi').length}</div>
                        </div>
                    </div>
                </div>
            `;
            
            raporSonuclari.innerHTML = raporHTML;
            showNotification(`${filtreliFormlar.length} kayƒ±t i√ßeren rapor olu≈üturuldu`, 'success');
        }

        // PDF raporu dƒ±≈üa aktarma
        function exportReportPDF() {
            const baslangic = document.getElementById('raporBaslangic').value;
            const bitis = document.getElementById('raporBitis').value;
            const tur = document.getElementById('raporTuru').value;
            
            if (!baslangic || !bitis) {
                showNotification('L√ºtfen rapor parametrelerini ayarlayƒ±n!', 'error');
                return;
            }
            
            const filtreliFormlar = servisFormlari.filter(form => {
                const formTarih = new Date(form.formTarihi);
                return formTarih >= new Date(baslangic) && formTarih <= new Date(bitis);
            });
            
            let content = `MCA MECHANICAL\n`;
            content += `${tur.toUpperCase()} RAPORU\n`;
            content += `=====================================\n`;
            content += `Tarih Aralƒ±ƒüƒ±: ${formatDate(baslangic)} - ${formatDate(bitis)}\n`;
            content += `Rapor Tarihi: ${new Date().toLocaleDateString('tr-TR')}\n\n`;
            
            let toplamIscilik = 0;
            
            filtreliFormlar.forEach(form => {
                const talep = isTalepleri.find(t => t.id === form.isTalebiId);
                toplamIscilik += form.iscilikUcreti;
                
                content += `Tarih: ${formatDate(form.formTarihi)}\n`;
                content += `Teknisyen: ${form.teknisyenAdi}\n`;
                content += `M√º≈üteri: ${talep ? talep.musteriAdi : 'Silinmi≈ü'}\n`;
                content += `ƒ∞≈ü T√ºr√º: ${talep ? talep.isTuru.toUpperCase() : '-'}\n`;
                content += `S√ºre: ${calculateDuration(form.baslangicSaati, form.bitisSaati)}\n`;
                content += `ƒ∞≈ü√ßilik: ${form.iscilikUcreti.toFixed(2)} ${ayarlar.paraBirimi}\n`;
                content += `Durum: ${getDurumText(form.durum)}\n`;
                content += `Yapƒ±lan ƒ∞≈üler: ${form.yapilanIsler}\n`;
                content += `---\n`;
            });
            
            content += `\n√ñZET Bƒ∞LGƒ∞LER:\n`;
            content += `=====================================\n`;
            content += `Toplam ƒ∞≈ü Sayƒ±sƒ±: ${filtreliFormlar.length}\n`;
            content += `Toplam ƒ∞≈ü√ßilik: ${toplamIscilik.toFixed(2)} ${ayarlar.paraBirimi}\n`;
            content += `Ortalama ƒ∞≈ü√ßilik: ${(toplamIscilik / filtreliFormlar.length).toFixed(2)} ${ayarlar.paraBirimi}\n`;
            content += `Onaylanan ƒ∞≈üler: ${filtreliFormlar.filter(f => f.durum === 'onaylandi').length}\n\n`;
            content += `MCA MECHANICAL - ${ayarlar.bolge}`;
            
            downloadTextFile(content, `${tur}_raporu_${baslangic}_${bitis}.txt`);
            showNotification('PDF raporu indirildi!', 'success');
        }

        // Tam yedek alma
        function exportFullBackup() {
            const backupData = {
                version: '2.0.0',
                timestamp: new Date().toISOString(),
                data: {
                    isTalepleri: isTalepleri,
                    servisFormlari: servisFormlari,
                    ayarlar: ayarlar,
                    pdfFiles: pdfFiles
                }
            };
            
            const jsonContent = JSON.stringify(backupData, null, 2);
            downloadTextFile(jsonContent, `mca_mechanical_yedek_${new Date().toISOString().split('T')[0]}.json`);
            showNotification('Tam yedek ba≈üarƒ±yla olu≈üturuldu!', 'success');
        }

        // Yedek i√ße aktarma
        function importBackup() {
            const input = document.getElementById('fileInput');
            
            input.onchange = function(e) {
                const file = e.target.files[0];
                if (!file) return;
                
                const reader = new FileReader();
                reader.onload = function(event) {
                    try {
                        const backupData = JSON.parse(event.target.result);
                        
                        if (confirm('Mevcut t√ºm veriler silinecek ve yedek veriler y√ºklenecek. Devam etmek istiyor musunuz?')) {
                            if (backupData.data) {
                                isTalepleri = backupData.data.isTalepleri || [];
                                servisFormlari = backupData.data.servisFormlari || [];
                                ayarlar = { ...ayarlar, ...(backupData.data.ayarlar || {}) };
                                pdfFiles = backupData.data.pdfFiles || [];
                            } else {
                                // Eski format desteƒüi
                                isTalepleri = backupData.isTalepleri || [];
                                servisFormlari = backupData.servisFormlari || [];
                                ayarlar = { ...ayarlar, ...(backupData.ayarlar || {}) };
                                pdfFiles = [];
                            }
                            
                            saveData();
                            loadSettingsToForm();
                            updateAllTables();
                            updateSummary();
                            updateArchiveStats();
                            displayPDFPreview();
                            
                            showNotification(`Yedek ba≈üarƒ±yla y√ºklendi! ${isTalepleri.length} i≈ü talebi, ${servisFormlari.length} servis formu, ${pdfFiles.length} PDF dosyasƒ± geri y√ºklendi.`, 'success');
                        }
                    } catch (error) {
                        console.error('Yedek y√ºkleme hatasƒ±:', error);
                        showNotification('Yedek dosyasƒ± ge√ßersiz!', 'error');
                    }
                };
                reader.readAsText(file);
            };
            
            input.click();
        }

        // T√ºm verileri temizle
        function clearAllData() {
            if (confirm('T√úM VERƒ∞LER Sƒ∞Lƒ∞NECEK! Bu i≈ülem geri alƒ±namaz. Emin misiniz?')) {
                if (confirm('Son kez soruyorum: T√ºm veriler ve PDF dosyalarƒ± silinecek. Devam etmek istiyor musunuz?')) {
                    isTalepleri = [];
                    servisFormlari = [];
                    pdfFiles = [];
                    saveData();
                    updateAllTables();
                    updateSummary();
                    updateArchiveStats();
                    displayPDFPreview();
                    showNotification('T√ºm veriler temizlendi!', 'success');
                }
            }
        }

        // Ayarlarƒ± kaydetme
        function saveSettings() {
            ayarlar.firmaAdi = document.getElementById('firmaAdi').value;
            ayarlar.bolge = document.getElementById('bolge').value;
            ayarlar.varsayilanTeknisyen = document.getElementById('varsayilanTeknisyen').value;
            ayarlar.paraBirimi = document.getElementById('paraBirimi').value;
            
            saveData();
            updateSummary();
            showNotification('Ayarlar ba≈üarƒ±yla kaydedildi!', 'success');
        }

        // Ayarlarƒ± forma y√ºkleme
        function loadSettingsToForm() {
            document.getElementById('firmaAdi').value = ayarlar.firmaAdi || 'MCA MECHANICAL';
            document.getElementById('bolge').value = ayarlar.bolge || 'Antalya';
            document.getElementById('varsayilanTeknisyen').value = ayarlar.varsayilanTeknisyen || '';
            document.getElementById('paraBirimi').value = ayarlar.paraBirimi || 'TL';
        }

        // Dosya indirme
        function downloadTextFile(content, filename) {
            const element = document.createElement('a');
            element.setAttribute('href', 'data:text/plain;charset=utf-8,' + encodeURIComponent(content));
            element.setAttribute('download', filename);
            element.style.display = 'none';
            document.body.appendChild(element);
            element.click();
            document.body.removeChild(element);
        }

        // Bildirim g√∂sterme
        function showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.textContent = message;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                if (notification.parentNode) {
                    notification.parentNode.removeChild(notification);
                }
            }, 4000);
        }

        // Modal kapatma
        function closeModal(modalId) {
            document.getElementById(modalId).style.display = 'none';
        }

        // Arama fonksiyonlarƒ±
        document.getElementById('searchIsTalepleri').addEventListener('input', function(e) {
            filterTable('isTalepleriTable', e.target.value);
        });
        
        document.getElementById('searchServisFormlari').addEventListener('input', function(e) {
            filterTable('servisFormlariTable', e.target.value);
        });

        function filterTable(tableId, searchTerm) {
            const table = document.getElementById(tableId);
            const rows = table.getElementsByTagName('tbody')[0].getElementsByTagName('tr');
            
            for (let i = 0; i < rows.length; i++) {
                const row = rows[i];
                const text = row.textContent.toLowerCase();
                row.style.display = text.includes(searchTerm.toLowerCase()) ? '' : 'none';
            }
        }

        // Modal kapatma event'leri
        function setupModalEvents() {
            // T√ºm close butonlarƒ± i√ßin event listener ekle
            document.querySelectorAll('.close').forEach(closeBtn => {
                closeBtn.onclick = function() {
                    this.closest('.modal').style.display = 'none';
                };
            });
        }

        window.onclick = function(event) {
            const modals = document.querySelectorAll('.modal');
            modals.forEach(modal => {
                if (event.target === modal) {
                    modal.style.display = 'none';
                }
            });
        }

        // Manuel modal kapatma fonksiyonu
        function closeModal(modalId) {
            document.getElementById(modalId).style.display = 'none';
        }

        // ESC tu≈üu ile modal kapatma
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                document.querySelectorAll('.modal').forEach(modal => {
                    if (modal.style.display === 'block') {
                        modal.style.display = 'none';
                    }
                });
            }
        });

        // Otomatik kaydetme
        setInterval(() => {
            saveData();
        }, 30000); // 30 saniyede bir otomatik kaydet
    </script>
</body>
</html><!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MCA MECHANICAL - Ar≈üiv Sistemi</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 10px;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
            color: white;
            padding: 25px;
            text-align: center;
        }
        
        .header h1 {
            font-size: 2.2rem;
            margin-bottom: 10px;
        }
        
        .header p {
            font-size: 1.1rem;
            opacity: 0.9;
        }
        
        .main-content {
            padding: 25px;
        }
        
        .tabs {
            display: flex;
            background: #f8f9fa;
            border-radius: 10px;
            margin-bottom: 25px;
            overflow-x: auto;
        }
        
        .tab-button {
            flex: 1;
            min-width: 140px;
            padding: 15px 20px;
            background: transparent;
            border: none;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            transition: all 0.3s ease;
            color: #666;
        }
        
        .tab-button.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
            animation: fadeIn 0.3s ease;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 25px;
        }
        
        .form-group {
            display: flex;
            flex-direction: column;
        }
        
        .form-group label {
            margin-bottom: 8px;
            font-weight: 600;
            color: #333;
        }
        
        .form-group input,
        .form-group select,
        .form-group textarea {
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 14px;
            transition: border-color 0.3s ease;
        }
        
        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: #667eea;
        }
        
        .btn {
            padding: 12px 25px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            transition: all 0.3s ease;
            margin: 5px;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }
        
        .btn-success {
            background: linear-gradient(135deg, #4CAF50 0%, #45a049 100%);
            color: white;
        }
        
        .btn-warning {
            background: linear-gradient(135deg, #FF9800 0%, #F57C00 100%);
            color: white;
        }
        
        .btn-danger {
            background: linear-gradient(135deg, #f44336 0%, #d32f2f 100%);
            color: white;
        }
        
        .btn-small {
            padding: 6px 12px;
            font-size: 12px;
            margin: 2px;
        }
        
        .table-container {
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }
        
        .table-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 20px;
            background: #f8f9fa;
            border-bottom: 1px solid #e0e0e0;
        }
        
        .search-box {
            padding: 8px 15px;
            border: 1px solid #ddd;
            border-radius: 20px;
            font-size: 14px;
            min-width: 200px;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
        }
        
        th {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 12px;
            text-align: left;
            font-weight: 600;
        }
        
        td {
            padding: 10px 12px;
            border-bottom: 1px solid #e0e0e0;
            font-size: 13px;
        }
        
        tr:nth-child(even) {
            background: #f8f9fa;
        }
        
        tr:hover {
            background: #e3f2fd;
        }
        
        .status-badge {
            padding: 4px 10px;
            border-radius: 15px;
            font-size: 11px;
            font-weight: 600;
            text-transform: uppercase;
        }
        
        .status-pending { background: #fff3cd; color: #856404; }
        .status-approved { background: #d4edda; color: #155724; }
        .status-completed { background: #d1ecf1; color: #0c5460; }
        
        .summary-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 25px;
        }
        
        .summary-card {
            background: linear-gradient(135deg, #fff 0%, #f8f9fa 100%);
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            text-align: center;
            transition: transform 0.3s ease;
        }
        
        .summary-card:hover {
            transform: translateY(-3px);
        }
        
        .summary-card h3 {
            color: #667eea;
            font-size: 1.8rem;
            margin-bottom: 8px;
        }
        
        .summary-card p {
            color: #666;
            font-weight: 600;
        }
        
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 20px;
            border-radius: 10px;
            color: white;
            font-weight: 600;
            z-index: 1000;
        }
        
        .notification.success { background: #4CAF50; }
        .notification.error { background: #f44336; }
        .notification.warning { background: #FF9800; }
        .notification.info { background: #2196F3; }
        
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
        }
        
        .modal-content {
            background: white;
            margin: 5% auto;
            padding: 25px;
            border-radius: 15px;
            width: 90%;
            max-width: 600px;
            max-height: 80vh;
            overflow-y: auto;
        }
        
        .close {
            color: #aaa;
            float: right;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
        }
        
        .close:hover {
            color: #000;
        }
        
        .pdf-section {
            background: #e8f5e8;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
        }
        
        .pdf-upload-area {
            border: 2px dashed #4CAF50;
            padding: 30px;
            text-align: center;
            border-radius: 10px;
            background: rgba(76, 175, 80, 0.1);
            margin: 15px 0;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .pdf-upload-area:hover {
            background: rgba(76, 175, 80, 0.2);
            border-color: #45a049;
        }
        
        .pdf-preview {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }
        
        .pdf-item {
            background: white;
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 15px;
            text-align: center;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        
        /* Responsive */
        @media (max-width: 768px) {
            .main-content {
                padding: 15px;
            }
            
            .form-grid {
                grid-template-columns: 1fr;
            }
            
            .search-box {
                min-width: auto;
                width: 100%;
            }
            
            .table-header {
                flex-direction: column;
                gap: 10px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üè¢ MCA MECHANICAL</h1>
            <p>Antalya B√∂lgesi - Servis Takip Sistemi</p>
        </div>
        
        <div class="main-content">
            <div class="tabs">
                <button class="tab-button active" onclick="showTab('is-talepleri')">üìã ƒ∞≈ü Talepleri</button>
                <button class="tab-button" onclick="showTab('servis-formlari')">üìù Servis Formlarƒ±</button>
                <button class="tab-button" onclick="showTab('raporlar')">üìà Raporlar</button>
                <button class="tab-button" onclick="showTab('arsiv')">üóÑÔ∏è PDF Ar≈üivi</button>
                <button class="tab-button" onclick="showTab('ayarlar')">‚öôÔ∏è Ayarlar</button>
            </div>
            
            <!-- ƒ∞≈ü Talepleri Tab -->
            <div id="is-talepleri" class="tab-content active">
                <h2 style="margin-bottom: 20px;">üìã Yeni ƒ∞≈ü Talebi Ekle</h2>
                <form id="isTalebiForm">
                    <div class="form-grid">
                        <div class="form-group">
                            <label>M√º≈üteri Adƒ± *</label>
                            <input type="text" id="musteriAdi" required>
                        </div>
                        <div class="form-group">
                            <label>Telefon</label>
                            <input type="tel" id="telefon">
                        </div>
                        <div class="form-group">
                            <label>Adres *</label>
                            <input type="text" id="adres" required>
                        </div>
                        <div class="form-group">
                            <label>ƒ∞≈ü T√ºr√º *</label>
                            <select id="isTuru" required>
                                <option value="">Se√ßiniz</option>
                                <option value="servis">Servis</option>
                                <option value="bakim">Bakƒ±m</option>
                                <option value="onarim">Onarƒ±m</option>
                                <option value="montaj">Montaj</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Cihaz Tipi *</label>
                            <input type="text" id="cihazTipi" required>
                        </div>
                        <div class="form-group">
                            <label>√úst Limit (TL) *</label>
                            <input type="number" id="ustLimit" min="0" step="0.01" required>
                        </div>
                        <div class="form-group">
                            <label>Tarih *</label>
                            <input type="date" id="tarih" required>
                        </div>
                        <div class="form-group">
                            <label>√ñncelik</label>
                            <select id="oncelik">
                                <option value="normal">Normal</option>
                                <option value="y√ºksek">Y√ºksek</option>
                                <option value="acil">Acil</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>ƒ∞≈ü A√ßƒ±klamasƒ±</label>
                        <textarea id="isAciklamasi" rows="3"></textarea>
                    </div>
                    <div style="margin-top: 20px;">
                        <button type="submit" class="btn btn-primary">‚úÖ ƒ∞≈ü Talebi Ekle</button>
                        <button type="reset" class="btn">üîÑ Temizle</button>
                    </div>
                </form>
                
                <div class="table-container" style="margin-top: 30px;">
                    <div class="table-header">
                        <h3>üìä Aktif ƒ∞≈ü Talepleri</h3>
                        <input type="text" class="search-box" id="searchIsTalepleri" placeholder="üîç Arama...">
                    </div>
                    <table id="isTalepleriTable">
                        <thead>
                            <tr>
                                <th>Tarih</th>
                                <th>M√º≈üteri</th>
                                <th>ƒ∞≈ü T√ºr√º</th>
                                <th>Cihaz</th>
                                <th>Limit</th>
                                <th>Durum</th>
                                <th>ƒ∞≈ülemler</th>
                            </tr>
                        </thead>
                        <tbody id="isTalepleriTbody">
                        </tbody>
                    </table>
                </div>
            </div>
            
            <!-- Servis Formlarƒ± Tab -->
            <div id="servis-formlari" class="tab-content">
                <h2 style="margin-bottom: 20px;">üìù G√ºnl√ºk Servis Formu</h2>
                <form id="servisFormForm">
                    <div class="form-grid">
                        <div class="form-group">
                            <label>ƒ∞≈ü Talebi Se√ß *</label>
                            <select id="isTalebiSec" required>
                                <option value="">Se√ßiniz</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Teknisyen Adƒ± *</label>
                            <input type="text" id="teknisyenAdi" required>
                        </div>
                        <div class="form-group">
                            <label>Ba≈ülangƒ±√ß Saati *</label>
                            <input type="time" id="baslangicSaati" required>
                        </div>
                        <div class="form-group">
                            <label>Biti≈ü Saati *</label>
                            <input type="time" id="bitisSaati" required>
                        </div>
                        <div class="form-group">
                            <label>ƒ∞≈ü√ßilik √úcreti (TL) *</label>
                            <input type="number" id="iscilikUcreti" min="0" step="0.01" required>
                        </div>
                        <div class="form-group">
                            <label>Form Tarihi *</label>
                            <input type="date" id="formTarihi" required>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Yapƒ±lan ƒ∞≈üler *</label>
                        <textarea id="yapilanIsler" rows="4" required></textarea>
                    </div>
                    <div class="form-group">
                        <label>Notlar</label>
                        <textarea id="notlar" rows="2"></textarea>
                    </div>
                    <div style="margin-top: 20px;">
                        <button type="submit" class="btn btn-success">üíæ Servis Formu Kaydet</button>
                        <button type="button" class="btn btn-warning" onclick="generatePDF()">üìÑ PDF Olu≈ütur</button>
                        <button type="reset" class="btn">üîÑ Temizle</button>
                    </div>
                </form>
                
                <div class="table-container" style="margin-top: 30px;">
                    <div class="table-header">
                        <h3>üìã Servis Formlarƒ±</h3>
                        <input type="text" class="search-box" id="searchServisFormlari" placeholder="üîç Arama...">
                    </div>
                    <table id="servisFormlariTable">
                        <thead>
                            <tr>
                                <th>Tarih</th>
                                <th>Teknisyen</th>
                                <th>M√º≈üteri</th>
                                <th>S√ºre</th>
                                <th>ƒ∞≈ü√ßilik</th>
                                <th>Durum</th>
                                <th>ƒ∞≈ülemler</th>
                            </tr>
                        </thead>
                        <tbody id="servisFormlariTbody">
                        </tbody>
                    </table>
                </div>
            </div>
            
            <!-- Raporlar Tab -->
            <div id="raporlar" class="tab-content">
                <h2 style="margin-bottom: 20px;">üìà Raporlar ve ƒ∞statistikler</h2>
                
                <div class="summary-cards">
                    <div class="summary-card">
                        <h3 id="toplamIsTalepleri">0</h3>
                        <p>Toplam ƒ∞≈ü Talepleri</p>
                    </div>
                    <div class="summary-card">
                        <h3 id="tamamlananIsler">0</h3>
                        <p>Tamamlanan ƒ∞≈üler</p>
                    </div>
                    <div class="summary-card">
                        <h3 id="bekleyenIsler">0</h3>
                        <p>Bekleyen ƒ∞≈üler</p>
                    </div>
                    <div class="summary-card">
                        <h3 id="toplamKazanc">‚Ç∫0</h3>
                        <p>Toplam Kazan√ß</p>
                    </div>
                </div>
                
                <div class="form-grid" style="background: #f8f9fa; padding: 20px; border-radius: 10px;">
                    <div class="form-group">
                        <label>Ba≈ülangƒ±√ß Tarihi</label>
                        <input type="date" id="raporBaslangic">
                    </div>
                    <div class="form-group">
                        <label>Biti≈ü Tarihi</label>
                        <input type="date" id="raporBitis">
                    </div>
                    <div class="form-group">
                        <label>Rapor T√ºr√º</label>
                        <select id="raporTuru">
                            <option value="genel">Genel Rapor</option>
                            <option value="teknisyen">Teknisyen Bazlƒ±</option>
                            <option value="finansal">Finansal Rapor</option>
                        </select>
                    </div>
                </div>
                
                <div style="margin-top: 20px;">
                    <button class="btn btn-primary" onclick="generateReport()">üìà Rapor Olu≈ütur</button>
                    <button class="btn btn-warning" onclick="exportReportPDF()">üìÑ PDF Raporu ƒ∞ndir</button>
                </div>
                
                <div id="raporSonuclari" style="margin-top: 30px;"></div>
            </div>
            
            <!-- PDF Ar≈üivi Tab -->
            <div id="arsiv" class="tab-content">
                <h2 style="margin-bottom: 20px;">üìÑ PDF Ar≈üivi ve Eski Form Aktarƒ±mƒ±</h2>
                
                <!-- Eski Formlarƒ± PDF Aktarma -->
                <div class="pdf-section">
                    <h3>üì§ Eski Formlarƒ± Sisteme Aktarma</h3>
                    <p>Elle doldurulmu≈ü servis formlarƒ±nƒ±zƒ± PDF olarak sisteme ekleyin ve manuel giri≈ü yapƒ±n.</p>
                    
                    <div class="pdf-upload-area" onclick="document.getElementById('pdfInput').click()">
                        <h4>üìÅ PDF Dosyalarƒ±nƒ± Buraya S√ºr√ºkleyin</h4>
                        <p>veya tƒ±klayarak se√ßin</p>
                        <small>Desteklenen formatlar: PDF, JPG, PNG</small>
                    </div>
                    
                    <input type="file" id="pdfInput" accept=".pdf,image/*" multiple style="display: none;">
                    
                    <div id="pdfPreview" class="pdf-preview">
                        <!-- Y√ºklenen PDF'ler burada g√∂sterilecek -->
                    </div>
                    
                    <div style="margin-top: 20px;">
                        <button class="btn btn-success" onclick="openQuickEntry()">üöÄ Hƒ±zlƒ± Form Giri≈üi</button>
                        <button class="btn btn-primary" onclick="showPDFViewer()">üëÅÔ∏è PDF G√∂r√ºnt√ºleyici</button>
                    </div>
                </div>
                
                <!-- Ar≈üiv ƒ∞statistikleri -->
                <div style="background: #f8f9fa; padding: 20px; border-radius: 10px; margin-bottom: 20px;">
                    <div class="summary-cards">
                        <div class="summary-card">
                            <h3 id="arsivisTalepleri">0</h3>
                            <p>ƒ∞≈ü Talepleri</p>
                        </div>
                        <div class="summary-card">
                            <h3 id="arsivServisFormlari">0</h3>
                            <p>Servis Formlarƒ±</p>
                        </div>
                        <div class="summary-card">
                            <h3 id="arsivPDFSayisi">0</h3>
                            <p>PDF Dosyalarƒ±</p>
                        </div>
                        <div class="summary-card">
                            <h3 id="arsivVeriBoyu">0 KB</h3>
                            <p>Veri Boyutu</p>
                        </div>
                    </div>
                </div>
                
                <div style="margin-top: 20px;">
                    <button class="btn btn-success" onclick="exportFullBackup()">üì¶ Tam Yedek Al</button>
                    <button class="btn btn-primary" onclick="importBackup()">üìÇ Yedek Y√ºkle</button>
                    <button class="btn btn-danger" onclick="clearAllData()">üóëÔ∏è T√ºm√ºn√º Temizle</button>
                </div>
            </div>
            
            <!-- Ayarlar Tab -->
            <div id="ayarlar" class="tab-content">
                <h2 style="margin-bottom: 20px;">‚öôÔ∏è Sistem Ayarlarƒ±</h2>
                
                <div class="form-grid">
                    <div class="form-group">
                        <label>Firma Adƒ±</label>
                        <input type="text" id="firmaAdi" value="MCA MECHANICAL">
                    </div>
                    <div class="form-group">
                        <label>B√∂lge</label>
                        <input type="text" id="bolge" value="Antalya">
                    </div>
                    <div class="form-group">
                        <label>Varsayƒ±lan Teknisyen</label>
                        <input type="text" id="varsayilanTeknisyen">
                    </div>
                    <div class="form-group">
                        <label>Para Birimi</label>
                        <select id="paraBirimi">
                            <option value="TL">T√ºrk Lirasƒ± (‚Ç∫)</option>
                            <option value="USD">Amerikan Dolarƒ± ($)</option>
                            <option value="EUR">Euro (‚Ç¨)</option>
                        </select>
                    </div>
                </div>
                
                <div style="margin-top: 20px;">
                    <button class="btn btn-primary" onclick="saveSettings()">üíæ Ayarlarƒ± Kaydet</button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Ana Modal -->
    <div id="detailModal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <div id="modalContent"></div>
        </div>
    </div>

    <!-- Hƒ±zlƒ± Giri≈ü Modal -->
    <div id="quickEntryModal" class="modal">
        <div class="modal-content" style="max-width: 800px;">
            <span class="close" onclick="closeModal('quickEntryModal')">&times;</span>
            <h3>üöÄ Hƒ±zlƒ± Eski Form Giri≈üi</h3>
            <p>Eski servis formlarƒ±nƒ±zƒ± PDF'lere bakarak hƒ±zlƒ±ca sisteme girin.</p>
            
            <form id="quickEntryForm">
                <div class="form-grid">
                    <div class="form-group">
                        <label>M√º≈üteri Adƒ± *</label>
                        <input type="text" id="qMusteriAdi" required>
                    </div>
                    <div class="form-group">
                        <label>Telefon</label>
                        <input type="tel" id="qTelefon">
                    </div>
                    <div class="form-group">
                        <label>Adres *</label>
                        <input type="text" id="qAdres" required>
                    </div>
                    <div class="form-group">
                        <label>ƒ∞≈ü T√ºr√º *</label>
                        <select id="qIsTuru" required>
                            <option value="servis">Servis</option>
                            <option value="bakim">Bakƒ±m</option>
                            <option value="onarim">Onarƒ±m</option>
                            <option value="montaj">Montaj</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Cihaz Tipi</label>
                        <input type="text" id="qCihazTipi">
                    </div>
                    <div class="form-group">
                        <label>Teknisyen *</label>
                        <input type="text" id="qTeknisyen" required>
                    </div>
                    <div class="form-group">
                        <label>Form Tarihi *</label>
                        <input type="date" id="qFormTarihi" required>
                    </div>
                    <div class="form-group">
                        <label>Ba≈ülangƒ±√ß Saati</label>
                        <input type="time" id="qBaslangic">
                    </div>
                    <div class="form-group">
                        <label>Biti≈ü Saati</label>
                        <input type="time" id="qBitis">
                    </div>
                    <div class="form-group">
                        <label>ƒ∞≈ü√ßilik √úcreti (TL) *</label>
                        <input type="number" id="qIscilik" step="0.01" required>
                    </div>
                </div>
                
                <div class="form-group">
                    <label>Yapƒ±lan ƒ∞≈üler *</label>
                    <textarea id="qYapilanIsler" rows="3" required></textarea>
                </div>
                
                <div class="form-group">
                    <label>Notlar</label>
                    <textarea id="qNotlar" rows="2"></textarea>
                </div>
                
                <div style="margin-top: 20px; display: flex; gap: 10px;">
                    <button type="submit" class="btn btn-success">üíæ